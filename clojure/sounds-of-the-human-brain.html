
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Sounds of the human brain - Joseph Wilk</title>
  <meta name="author" content="Joseph Wilk">

  
  <meta name="description" content="What does your brain sound like? Does it sound like &ldquo;Rise of the Valkyrie&rdquo; or more like &ldquo;Hit me baby one more time&rdquo;? Step 1: &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://josephwilk.github.io/clojure/sounds-of-the-human-brain.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Joseph Wilk" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<script src="http://disqus.com/forums/josephwilk/embed.js"></script>
<link href="http://fonts.googleapis.com/css?family=Bevan" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3020740-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <img src="/images/joe_small2.png" style="position:relative;border-radius: 8px;margin-right: 5px;border-style: solid;border-width: 1px;border-color: #DDD;" height="60" alt="Joseph Wilk">
  <span style="display:inline-block">
    <h1><a href="/">Joseph Wilk</a></h1>
    <h2>Things with code, creativity and computation.</h2>
  </span>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  

  
<ul class="main-navigation">
 <li><a href="/">Home</a></li>
 <li><a href="/about">About</a></li>
 <li><a href="/speaking">Speaking</a></li>
 <li><a href="/art">Art</a></li>
 <li><a href="/contact">Contact</a></li>
 <li><a href="/archives">Archives</a></li>
</ul>
</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Sounds of the Human Brain</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-02T13:23:00+00:00" pubdate data-updated="true">Dec 2<span>nd</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>What does your brain sound like? Does it sound like &ldquo;Rise of the Valkyrie&rdquo; or more like &ldquo;Hit me baby one more time&rdquo;?</p>

<h2>Step 1: Acquire a human brain (alive)</h2>

<p><img src="/images/brain.png" width="200px"></p>

<p>We are interested in capturing the brain waves. Specifically the:</p>

<ul>
<li>Delta waves: Deepest stages of sleep.</li>
<li>Beta waves:  Normal waking consciousness.</li>
<li>Alpha waves: Relaxation and meditation (creativity).</li>
<li>Theta waves: REM sleep (dreams).</li>
<li>Gamma waves: Hyper-alertness, perception, and integration of sensory input.</li>
</ul>


<h2>Step 2: EEG machine</h2>

<p>I am using a EEG machine brought from <a href="http://www.neurosky.com">Neurosky</a> which is rated as Research grade (whatever that means).
This measures voltage fluctuations resulting from ionic current flows within the neurons of the brain. While EEG machines are not the most accurate they are now reasonably cheap.</p>

<h2>Step 3: EEG &ndash;> Overtone</h2>

<p>In order to generate music I want to import the EEG brainwave data into <a href="http://overtone.github.io">Overtone</a>.</p>

<p>We interact with the EEG machine over a serial port. The most mature library for this interface is in Python so there is a little jiggery pokery to get the data into Overtone.</p>

<p><img src="/images/brain-diagram.png"></p>

<h4>The Brainwave Poller</h4>

<p>We use <a href="https://github.com/akloster/python-mindwave">https://github.com/akloster/python-mindwave</a> to interface with the EEG machines data.</p>

<p>Writing all the data out to a <a href="http://www.gnu.org/software/libc/manual/html_node/FIFO-Special-Files.html">FIFO file</a> file as json.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">re</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">time</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">json</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">unicodedata</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">gevent</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">gevent</span> <span class="kn">import</span> <span class="n">monkey</span>
</span><span class='line'>
</span><span class='line'><span class="kn">from</span> <span class="nn">pymindwave</span> <span class="kn">import</span> <span class="n">headset</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">pymindwave.pyeeg</span> <span class="kn">import</span> <span class="n">bin_power</span>
</span><span class='line'>
</span><span class='line'><span class="n">monkey</span><span class="o">.</span><span class="n">patch_all</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'><span class="c"># connect to the headset</span>
</span><span class='line'><span class="n">hs</span> <span class="o">=</span> <span class="bp">None</span>
</span><span class='line'><span class="n">hs</span> <span class="o">=</span> <span class="n">headset</span><span class="o">.</span><span class="n">Headset</span><span class="p">(</span><span class="s">&#39;/dev/tty.MindWave&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">hs</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</span><span class='line'><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'><span class="k">print</span> <span class="s">&#39;connecting to headset...&#39;</span>
</span><span class='line'><span class="n">hs</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</span><span class='line'><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'><span class="k">while</span> <span class="n">hs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;state&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s">&#39;connected&#39;</span><span class="p">:</span>
</span><span class='line'>    <span class="k">print</span> <span class="n">hs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;state&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">hs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;state&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;standby&#39;</span><span class="p">:</span>
</span><span class='line'>        <span class="n">hs</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</span><span class='line'>        <span class="k">print</span> <span class="s">&#39;retrying connecting to headset&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">raw_to_spectrum</span><span class="p">(</span><span class="n">rawdata</span><span class="p">):</span>
</span><span class='line'>    <span class="n">flen</span> <span class="o">=</span> <span class="mi">50</span>
</span><span class='line'>    <span class="n">spectrum</span><span class="p">,</span> <span class="n">relative_spectrum</span> <span class="o">=</span> <span class="n">bin_power</span><span class="p">(</span><span class="n">rawdata</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">flen</span><span class="p">),</span> <span class="mi">512</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">spectrum</span>
</span><span class='line'>
</span><span class='line'><span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
</span><span class='line'>    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span class='line'>    <span class="n">waves_vector</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;waves_vector&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">meditation</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;meditation&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">attention</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;attention&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">spectrum</span> <span class="o">=</span> <span class="n">raw_to_spectrum</span><span class="p">(</span><span class="n">hs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;rawdata&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;/tmp/brain-data&quot;</span><span class="p">,</span><span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
</span><span class='line'>        <span class="n">s</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span>
</span><span class='line'>             <span class="s">&#39;meditation&#39;</span><span class="p">:</span> <span class="n">meditation</span><span class="p">,</span>
</span><span class='line'>             <span class="s">&#39;attention&#39;</span><span class="p">:</span> <span class="n">attention</span><span class="p">,</span>
</span><span class='line'>             <span class="s">&#39;raw_spectrum&#39;</span><span class="p">:</span> <span class="n">spectrum</span><span class="p">,</span>
</span><span class='line'>             <span class="s">&#39;delta_waves&#39;</span><span class="p">:</span> <span class="n">waves_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span class='line'>             <span class="s">&#39;theta_waves&#39;</span><span class="p">:</span> <span class="n">waves_vector</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span class='line'>             <span class="s">&#39;alpha_waves&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">waves_vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">waves_vector</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
</span><span class='line'>             <span class="s">&#39;low_alpha_waves&#39;</span><span class="p">:</span> <span class="n">waves_vector</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
</span><span class='line'>             <span class="s">&#39;high_alpha_waves&#39;</span><span class="p">:</span> <span class="n">waves_vector</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
</span><span class='line'>             <span class="s">&#39;beta_waves&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">waves_vector</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="n">waves_vector</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
</span><span class='line'>             <span class="s">&#39;low_beta_waves&#39;</span><span class="p">:</span> <span class="n">waves_vector</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
</span><span class='line'>             <span class="s">&#39;high_beta_waves&#39;</span><span class="p">:</span> <span class="n">waves_vector</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
</span><span class='line'>             <span class="s">&#39;gamma_waves&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">waves_vector</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="n">waves_vector</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
</span><span class='line'>             <span class="s">&#39;low_gamma_waves&#39;</span><span class="p">:</span> <span class="n">waves_vector</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>
</span><span class='line'>             <span class="s">&#39;mid_gamma_waves&#39;</span><span class="p">:</span> <span class="n">waves_vector</span><span class="p">[</span><span class="mi">7</span><span class="p">]}</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">s</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span class='line'>        <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span class='line'>    <span class="n">gevent</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Reading from the FIFO file is simple in Clojure.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">while</span> <span class="nv">true</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">with-open </span><span class="p">[</span><span class="nv">reader</span> <span class="p">(</span><span class="nf">clojure.java.io/reader</span> <span class="s">&quot;/tmp/brain-data&quot;</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">brainwave-&gt;music</span> <span class="p">(</span><span class="nf">json/decode</span> <span class="p">(</span><span class="nb">first </span><span class="p">(</span><span class="nb">line-seq </span><span class="nv">reader</span><span class="p">))</span> <span class="nv">true</span><span class="p">))))</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Step 3: Sonification</h2>

<p>Sonification is the process of taking data and turning it into sound. Here is an example of the data we are now receiving:</p>

<p>A single JSON brainwave packet:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'> <span class="p">{</span><span class="s">&quot;gamma_waves&quot;</span><span class="err">:</span> <span class="mi">95408</span>,
</span><span class='line'>  <span class="s">&quot;high_beta_waves&quot;</span><span class="err">:</span> <span class="mi">205681</span>,
</span><span class='line'>  <span class="s">&quot;beta_waves&quot;</span><span class="err">:</span> <span class="mi">293928</span>,
</span><span class='line'>  <span class="s">&quot;low_beta_waves&quot;</span><span class="err">:</span> <span class="mi">382176</span>,
</span><span class='line'>  <span class="s">&quot;mid_gamma_waves&quot;</span><span class="err">:</span> <span class="mi">84528</span>,
</span><span class='line'>  <span class="s">&quot;low_alpha_waves&quot;</span><span class="err">:</span> <span class="mi">172417</span>,
</span><span class='line'>  <span class="s">&quot;delta_waves&quot;</span><span class="err">:</span> <span class="mi">117933</span>,
</span><span class='line'>  <span class="s">&quot;low_gamma_waves&quot;</span><span class="err">:</span> <span class="mi">106288</span>,
</span><span class='line'>  <span class="s">&quot;alpha_waves&quot;</span><span class="err">:</span> <span class="mi">112605</span>,
</span><span class='line'>  <span class="s">&quot;theta_waves&quot;</span><span class="err">:</span> <span class="mi">635628</span>,
</span><span class='line'>  <span class="s">&quot;high_alpha_waves&quot;</span><span class="err">:</span> <span class="mi">52793</span>,
</span><span class='line'>  <span class="s">&quot;attention&quot;</span><span class="err">:</span> <span class="mi">0</span>,
</span><span class='line'>  <span class="s">&quot;meditation&quot;</span><span class="err">:</span> <span class="mi">0</span>,
</span><span class='line'>  <span class="s">&quot;timestamp&quot;</span><span class="err">:</span> <span class="mf">1.375811275696894</span><span class="nv">E9</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>We will focus on the beta-waves for simplicity. Beta-waves fall between 16.5–20Hz.</p>

<p><img alt="EEG beta waves" src="/images/eeg_beta.png"></p>

<p>Beta waves related to:</p>

<ul>
<li>Alertness</li>
<li>Logic</li>
<li>Critical reasoning</li>
</ul>


<p> We need to map a signal within 16.5-20Hz into the musical pitches of a sampled piano (21-108 pitches).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">require</span> <span class="o">&#39;</span><span class="p">[</span><span class="nv">clojure.math.numeric-tower</span> <span class="ss">:as</span> <span class="nv">math</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">linear-map</span> <span class="p">[</span><span class="nv">x0</span> <span class="nv">x1</span> <span class="nv">y0</span> <span class="nv">y1</span> <span class="nv">x</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">dydx</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">- </span><span class="nv">y1</span> <span class="nv">y0</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">x1</span> <span class="nv">x0</span><span class="p">))</span>
</span><span class='line'>        <span class="nv">dx</span> <span class="p">(</span><span class="nb">- </span><span class="nv">x</span> <span class="nv">x0</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">+ </span><span class="nv">y0</span> <span class="p">(</span><span class="nb">* </span><span class="nv">dydx</span> <span class="nv">dx</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;; Piano range: 0..87</span>
</span><span class='line'><span class="c1">;; Beta wave range: 16500..20000</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">beta-wave-&gt;pitch</span> <span class="p">[</span><span class="nv">signal</span><span class="p">]</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">linear-map</span> <span class="mi">16500</span> <span class="mi">20000</span> <span class="mi">21</span> <span class="mi">108</span> <span class="nv">signal</span><span class="p">)</span> <span class="nb">float </span><span class="nv">math/round</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">beta-wave-&gt;pitch</span> <span class="mi">16500</span><span class="p">)</span> <span class="c1">;-&gt; 21</span>
</span><span class='line'><span class="p">(</span><span class="nf">beta-wave-&gt;pitch</span> <span class="mi">20000</span><span class="p">)</span> <span class="c1">;-&gt; 108</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we extract the beta-waves from the brainwave data and play them. We play them live as they arrive rather than worrying about scheduling notes:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">use</span> <span class="ss">&#39;overtone.live</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">use</span> <span class="ss">&#39;overtone.inst.sampled-piano</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">require</span> <span class="o">&#39;</span><span class="p">[</span><span class="nv">cheshire.core</span> <span class="ss">:as</span> <span class="nv">json</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">while</span> <span class="nv">true</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">with-open </span><span class="p">[</span><span class="nv">reader</span> <span class="p">(</span><span class="nf">clojure.java.io/reader</span> <span class="s">&quot;/tmp/brain-data&quot;</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">beta-wave</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nb">first </span><span class="p">(</span><span class="nb">line-seq </span><span class="nv">reader</span><span class="p">))</span> <span class="p">(</span><span class="nf">json/decode</span> <span class="nv">true</span><span class="p">)</span> <span class="ss">:beta_waves</span><span class="p">)]</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">println </span><span class="nv">beta-wave</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">sampled-piano</span> <span class="ss">:note</span> <span class="p">(</span><span class="nf">beta-wave-&gt;pitch</span> <span class="nv">beta-wave</span><span class="p">)</span> <span class="ss">:sustain</span> <span class="mf">0.2</span><span class="p">))))</span>
</span></code></pre></td></tr></table></div></figure>


<h1>Would you like to hear my brain?</h1>

<p>The results, please listen to my brain.</p>

<div><iframe width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F108320470&amp;color=ff6600&amp;auto_play=false&amp;show_artwork=false"></iframe></div>


<p>Not really music is it? With beta-waves we get a serious of high to low transitions. While we can control at what pitch the transitions occur by performing activities that shape our brain waves the transitions don&rsquo;t provide the order or structure we need to recognize this as music.</p>

<h2>Brain controlled Dubstep</h2>

<p>The only logical path left is to try and control Dubstep with our brain. Rather than generative music we can use our brain waves to control the tempo and volume of existing synthesized music.</p>

<p>Here is a Dubstep synth taken from Overtone:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">use</span> <span class="ss">&#39;overtone.live</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">defsynth</span> <span class="nv">dubstep</span> <span class="p">[</span><span class="nv">bpm</span> <span class="mi">120</span> <span class="nv">wobble</span> <span class="mi">1</span> <span class="nv">note</span> <span class="mi">50</span> <span class="nv">snare-vol</span> <span class="mi">1</span> <span class="nv">kick-vol</span> <span class="mi">1</span> <span class="nv">volume</span> <span class="mi">1</span> <span class="nv">out-bus</span> <span class="mi">0</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">trig</span> <span class="p">(</span><span class="nf">impulse</span><span class="ss">:kr</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">bpm</span> <span class="mi">120</span><span class="p">))</span>
</span><span class='line'>        <span class="nv">freq</span> <span class="p">(</span><span class="nf">midicps</span> <span class="nv">note</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">swr</span> <span class="p">(</span><span class="nf">demand</span> <span class="nv">trig</span> <span class="mi">0</span> <span class="p">(</span><span class="nf">dseq</span> <span class="p">[</span><span class="nv">wobble</span><span class="p">]</span> <span class="nv">INF</span><span class="p">))</span>
</span><span class='line'>        <span class="nv">sweep</span> <span class="p">(</span><span class="nf">lin-exp</span> <span class="p">(</span><span class="nf">lf-tri</span> <span class="nv">swr</span><span class="p">)</span> <span class="mi">-1</span> <span class="mi">1</span> <span class="mi">40</span> <span class="mi">3000</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">wob</span> <span class="p">(</span><span class="nb">apply + </span><span class="p">(</span><span class="nf">saw</span> <span class="p">(</span><span class="nb">* </span><span class="nv">freq</span> <span class="p">[</span><span class="mf">0.99</span> <span class="mf">1.01</span><span class="p">])))</span>
</span><span class='line'>        <span class="nv">wob</span> <span class="p">(</span><span class="nf">lpf</span> <span class="nv">wob</span> <span class="nv">sweep</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">wob</span> <span class="p">(</span><span class="nb">* </span><span class="mf">0.8</span> <span class="p">(</span><span class="nf">normalizer</span> <span class="nv">wob</span><span class="p">))</span>
</span><span class='line'>        <span class="nv">wob</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">wob</span> <span class="p">(</span><span class="nf">bpf</span> <span class="nv">wob</span> <span class="mi">1500</span> <span class="mi">2</span><span class="p">))</span>
</span><span class='line'>        <span class="nv">wob</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">wob</span> <span class="p">(</span><span class="nb">* </span><span class="mf">0.2</span> <span class="p">(</span><span class="nf">g-verb</span> <span class="nv">wob</span> <span class="mi">9</span> <span class="mf">0.7</span> <span class="mf">0.7</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'>        <span class="nv">kickenv</span> <span class="p">(</span><span class="nf">decay</span> <span class="p">(</span><span class="nf">t2a</span> <span class="p">(</span><span class="nf">demand</span> <span class="p">(</span><span class="nf">impulse</span><span class="ss">:kr</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">bpm</span> <span class="mi">30</span><span class="p">))</span> <span class="mi">0</span> <span class="p">(</span><span class="nf">dseq</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span> <span class="nv">INF</span><span class="p">)))</span> <span class="mf">0.7</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">kick</span> <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nb">* </span><span class="nv">kickenv</span> <span class="mi">7</span><span class="p">)</span> <span class="p">(</span><span class="nf">sin-osc</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">40</span> <span class="p">(</span><span class="nb">* </span><span class="nv">kickenv</span> <span class="nv">kickenv</span> <span class="nv">kickenv</span> <span class="mi">200</span><span class="p">))))</span>
</span><span class='line'>        <span class="nv">kick</span> <span class="p">(</span><span class="nf">clip2</span> <span class="nv">kick</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="nv">snare</span> <span class="p">(</span><span class="nb">* </span><span class="mi">3</span> <span class="p">(</span><span class="nf">pink-noise</span><span class="p">)</span> <span class="p">(</span><span class="nb">apply + </span><span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">decay</span> <span class="p">(</span><span class="nf">impulse</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">bpm</span> <span class="mi">240</span><span class="p">)</span> <span class="mf">0.5</span><span class="p">)</span> <span class="p">[</span><span class="mf">0.4</span> <span class="mi">2</span><span class="p">])</span> <span class="p">[</span><span class="mi">1</span> <span class="mf">0.05</span><span class="p">])))</span>
</span><span class='line'>        <span class="nv">snare</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">snare</span> <span class="p">(</span><span class="nf">bpf</span> <span class="p">(</span><span class="nb">* </span><span class="mi">4</span> <span class="nv">snare</span><span class="p">)</span> <span class="mi">2000</span><span class="p">))</span>
</span><span class='line'>        <span class="nv">snare</span> <span class="p">(</span><span class="nf">clip2</span> <span class="nv">snare</span> <span class="mi">1</span><span class="p">)]</span>
</span><span class='line'>
</span><span class='line'>       <span class="p">(</span><span class="nf">out</span> <span class="nv">out-bus</span> <span class="p">(</span><span class="nb">* </span><span class="nv">volume</span> <span class="p">(</span><span class="nf">clip2</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">wob</span> <span class="p">(</span><span class="nb">* </span><span class="nv">kick-vol</span> <span class="nv">kick</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="nv">snare-vol</span> <span class="nv">snare</span><span class="p">))</span> <span class="mi">1</span><span class="p">)))))</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>Once the synth is running we can send it control signals which will vary any of the properties defined in the arguments to the dubstep function:</p>

<ul>
<li>bpm</li>
<li>wobble</li>
<li>note</li>
<li>snare-vol</li>
<li>kick-vol</li>
<li>volume</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">d</span> <span class="p">(</span><span class="nf">dubstep</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">ctl</span> <span class="nv">d</span> <span class="ss">:snare-vol</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">ctl</span> <span class="nv">d</span> <span class="ss">:kick-vol</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">ctl</span> <span class="nv">d</span> <span class="ss">:wooble</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">ctl</span> <span class="nv">d</span> <span class="ss">:bpm</span> <span class="mi">20</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">ctl</span> <span class="nv">d</span> <span class="ss">:v</span> <span class="mf">0.2</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>We again have to linearise the beta wave signal to the range of volume 0.0-1.1 and to the bpm 0-400.</p>

<p>Now all thats left to do is connect it to our brain.</p>

<p>Here&rsquo;s what brain controlled Dubstep sounds like:</p>

<div><iframe width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/119776808&amp;color=ff6600&amp;auto_play=false&amp;show_artwork=false"></iframe></div>


<p>And for comparison what playing Go does to your brain activity (I turned the Dubstep down while playing, concentrating with that noise is hard):</p>

<div><iframe width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/122704897&amp;color=ff6600&amp;auto_play=false&amp;show_artwork=false"></iframe></div>


<h1>Discovery through sound</h1>

<p>Mapping brain waves into live music is a challenging task and while we can control music through an EEG machine that control is hard since we are using the brain to do many other things. What is interesting in the path of this experiment is not in fact the music generated but the use of sound to provide a way to hear the differences in datasets.</p>

<p>Hearing the difference between play Go or sleeping, between young people or old people.</p>

<p>Sound as a means of discovering patterns is a largely untapped source.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Joseph Wilk</span></span>

      








  


<time datetime="2013-12-02T13:23:00+00:00" pubdate data-updated="true">Dec 2<span>nd</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/clojure'>clojure</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://josephwilk.github.io/clojure/sounds-of-the-human-brain.html" data-via="josephwilk" data-counturl="http://josephwilk.github.io/clojure/sounds-of-the-human-brain.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="small"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/clojure/building-clojure-services-at-scale.html" title="Previous Post: Building Clojure services at scale">&laquo; Building Clojure services at scale</a>
      
      
        <a class="basic-alignment right" href="/clojure/creative_machines.html" title="Next Post: Creative Machines">Creative Machines &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
    <li class="post">
      <a href="/art/audio-fingerprint-smudges.html">Audio Fingerprint Smudges</a>
    </li>
	
      <li class="post">
        <a href="/art/overtone-shader-visuals.html">Visuals with Overtone and Shadertone</a>
      </li>
    
      <li class="post">
        <a href="/art/emacs-animation.html">Animations with Emacs</a>
      </li>
    
      <li class="post">
        <a href="/clojure/clojure-and-kinesis-at-scale.html">Clojure and Kinesis at scale</a>
      </li>
    
      <li class="post">
        <a href="/clojure/overtone-driving-minecraft.html">Clojure and Overtone driving Minecraft</a>
      </li>
    
      <li class="post">
        <a href="/art/live-coding-repl-electric.html">Live Coding - Repl Electric</a>
      </li>
    
      <li class="post">
        <a href="/clojure/creative_machines.html">Creative Machines</a>
      </li>
    
      <li class="post">
        <a href="/clojure/sounds-of-the-human-brain.html">Sounds of the human brain</a>
      </li>
    
      <li class="post">
        <a href="/clojure/building-clojure-services-at-scale.html">Building Clojure services at scale</a>
      </li>
    
      <li class="post">
        <a href="/clojure/creating-instruments-with-overtone.html">Creating sampled instruments with Overtone</a>
      </li>
    
      <li class="post">
        <a href="/elixir/sets-in-elixir.html">Sets in Elixir</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/josephwilk">@josephwilk</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'josephwilk',
            count: 10,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - Joseph Wilk -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'josephwilk';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://josephwilk.github.io/clojure/sounds-of-the-human-brain.html';
        var disqus_url = 'http://josephwilk.github.io/clojure/sounds-of-the-human-brain.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
