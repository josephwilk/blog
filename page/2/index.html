
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Joseph Wilk</title>
  <meta name="author" content="Joseph Wilk">

  
  <meta name="description" content="Being shouted at is not a lot of fun. So why do we shout in code? Shouting code Compare "how_many_monkeys_can_a_monkey_eat_before_it_explodes" and: " &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://josephwilk.github.io/page/2/index.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Joseph Wilk" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<script src="http://disqus.com/forums/josephwilk/embed.js"></script>
<link href="http://fonts.googleapis.com/css?family=Bevan" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3020740-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <img src="/images/joe_small.jpg" style="position:relative;border-radius: 8px;margin-right: 5px;border-style: solid;border-width: 1px;border-color: #DDD;" height="60" alt="Joseph Wilk">
  <span style="display:inline-block">
    <h1><a href="/">Joseph Wilk</a></h1>
    <h2>Programming bits and bobs</h2>
  </span>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:josephwilk.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
 <li><a href="/">Home</a></li>
 <li><a href="/about">About</a></li>
 <li><a href="/speaking">Speaking</a></li>
 <li><a href="/contact">Contact</a></li>
 <li><a href="/archives">Archives</a></li>
</ul>
</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/rhetorical-programming/why-are-you-shouting-programmer.html">Why Are You SHOUTING Programmer?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-11-19T00:00:51+00:00" pubdate data-updated="true">Nov 19<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Being shouted at is not a lot of fun. So why do we shout in code?</p>

<p><img src="/images/blog/2012/11/image1-201x300.jpg" alt="" /></p>

<h2>Shouting code</h2>

<p>Compare</p>

<pre><code>"how_many_monkeys_can_a_monkey_eat_before_it_explodes"
</code></pre>

<p>and:</p>

<pre><code>"HOW_MANY_MONKEYS_CAN_A_MONKEY_EAT_BEFORE_IT_EXPLODES"
</code></pre>

<p>How do you read those differently in your head?</p>

<p>We associate capital letters with someone shouting.</p>

<p>Now lets turn to two functionally equivalent pieces of Ruby code:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Monkey</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">capacity</span>
</span><span class='line'>    <span class="mi">10</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">stomach</span>
</span><span class='line'>      <span class="s2">&quot;I can fit </span><span class="si">#{</span><span class="n">capacity</span><span class="si">}</span><span class="s2"> monkeys in my belly&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>And</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Monkey</span>
</span><span class='line'>  <span class="no">CAPACITY</span> <span class="o">=</span> <span class="mi">10</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">stomach</span>
</span><span class='line'>    <span class="s2">&quot;I can fit </span><span class="si">#{</span><span class="no">CAPACITY</span><span class="si">}</span><span class="s2"> monkeys in my belly&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Constants are shouted. Why do we shout? Because:</p>

<ul>
<li><p>We are angry</p></li>
<li><p>We have something we think is important and we want everyone to hear it.</p></li>
</ul>


<p>Why in Ruby are constants uppercase? Well they don&rsquo;t have to be, Ruby constrains us to ensuring the first letter is a capital.
We get warnings if we try and reassign their value but ultimately they are just Fixnums. In order to stick with our Ruby naming convention we use &lsquo;_&rsquo; and all caps.</p>

<p>So its a combination or <strong>telling the compiler that this value is a constant</strong> and <strong>fitting with the naming scheme</strong> in Ruby.</p>

<p>We shout because society indicates to us thats the normal behaviour and we all want to be nice citizens of the Ruby republic.</p>

<p>As a side effect constants feel like they are more important than the other variables or methods. They should take our attention first.</p>

<h2>Reading uppercase is slow</h2>

<p>What wait a minute isn&rsquo;t uppercase text harder to read? There is evidence [1] to show that all-caps is less legible and less readable than lower case. So constants are harder for us to read.</p>

<blockquote><p>lowercase permits reading by word units, while all capitals tend to be read letter by letter</p></blockquote>

<h2>Numbers, letters and uppercase</h2>

<p>A common use of shouting case is constants used to remove magic numbers from calculations.</p>

<pre><code>1000 * 667895 / LIMIT + 475436
</code></pre>

<p>The brain recognises numbers and letters very differently. The brain in general can recognise words faster than a sequence of digits since with a word we do not need to read each character in order to recognise the word.</p>

<p>To see for yourself try and read the following:</p>

<blockquote><p>The hmaun mind does not raed eervy letter by istlef but the word as aa woelh.</p></blockquote>

<p>Compare how much more time it takes you to read the numbers.</p>

<blockquote><p>124 3456 3234 5443 3342 55334 66554 47567</p></blockquote>

<p>By uppercasing the constant we are slowing down this natural ability to read words.</p>

<p>Compare again:</p>

<pre><code>1000 * 667895 / LIMIT + 475436
</code></pre>

<p>With:</p>

<pre><code>1000 * 667895 / limit + 475436
</code></pre>

<p>Do we really need this further uppercase difference? With the instinctive separation between words and letters the further effort and cognitive slow down has little value.</p>

<h3>Immutability vs Mutability</h3>

<p>A legitimate case were it does become useful to use shouting case is where you want to distinguish between variables/functions and constants. Expressing that a value is immutable in comparison to a mutable variable is important in a language like Ruby were immutability is not the norm.</p>

<pre><code>1000 * 667895 + scale / LIMIT + 475436 - radius
</code></pre>

<h2>Shouting in technicolor</h2>

<p>Editors often provide color markup for words in uppercase. For example for Ruby in Textmate:</p>

<p><img src="/images/blog/2012/11/Screen-Shot-2012-11-17-at-15.00.41.png" alt="" /></p>

<p>Though they also provide the difference between variables/function and numbers.
Shouting provides us with a discernible way to see all constants within the code at glance based on colour.</p>

<h2>History of shouting in code</h2>

<p>How or where did this convention of uppercasing constants come from?
Why is it a convention?
When did we start shouting in our code?</p>

<p>What made us so mad?</p>

<h4>Assembly</h4>

<p>It started with assembly,  the convention was to uppercase variables names and lowercase instructions.</p>

<pre><code>ADCTL  = 0x30
staa ADCTL,X
</code></pre>

<p>Variable names were limited in length, so often variable names were acronyms, which in English are often capitalised (we just skipped the dot). Registers, memory &amp; caches all had nice acronyms which you could reference in your assembly.</p>

<p><img src="/images/blog/2012/11/image5-150x150.jpg" alt="" /></p>

<p>Assembly was more machine centric than human centric. Not quite shouting as we know it now (though its understandable we were angry with all that ugly code).</p>

<h4>FLOW-MATIC</h4>

<p>The birth of programming in English. It was not a pretty birth, this thing was born shouting very loudly. EVERYTHING is in capitals, even the programming languages name!</p>

<pre><code>INPUT  INVENTORY FILE=A
 PRICE FILE=B,
 OUTPUT PRICED-INV FILE=C
 UNPRICED-INV FILE=D,
 HSP D.
</code></pre>

<p>Flow-Matic had the builtin in constant ZERO. Our first example of a Constant but where everything is capitalised so it is not distinguished from other code.</p>

<h4>FORTRAN</h4>

<p>FORTRAN was a confused language when it came to shouting. The use of lowercase letters in keywords was strictly nonstandard.</p>

<pre><code>IF (IA+IC-IB) 777,777,705
IF (IB+IC-IA) 777,777,799
STOP 1
C USING HERON'S FORMULA WE CALCULATE THE
C AREA OF THE TRIANGLE
S = FLOATF (IA + IB + IC) / 2.0
AREA = SQRT( S * (S - FLOATF(IA)) * (S - FLOATF(IB)) + (S - FLOATF(IC)))
WRITE OUTPUT TAPE 6, 601, IA, IB,
STOP
END
</code></pre>

<p>But then the liberation came and after a bloody battle FORTRAN was renamed Fortran.</p>

<p><img src="/images/blog/2012/11/fist-150x150.png" alt="" /></p>

<p>In this new post revolution age Fortran&rsquo;s compiler was a liberal one, not caring about shouting or case at all.</p>

<pre><code>program helloworld
     print *, "Hello, world."
end program helloworld
</code></pre>

<p>The society on the other hand was still very keen to tell its citizens when they should shout. It was a social coding convention that local variables be in lowercase and language keywords be in uppercase.</p>

<p>Language keywords were more important and hence shouted. Far more important than those pesky human named local variables. This inverted the previous Assembly conventions on the use of case.</p>

<h4>LISP</h4>

<p>Common Lisp is case sensitive but the Common Lisp reader converts all uppercase to lower case:</p>

<pre><code>(defun hi () "Hi!)
(hi) ;; outputs "Hi"
(HI) ;; outputs "Hi"
(Hi) ;; outputs "Hi"
</code></pre>

<p>LISP had a social convention to only use lowercase (one might think to avoid confusing situations like the one above). Did LISPeans shout at all? They did when it came to  documentation strings:</p>

<blockquote><p>&ldquo;In a documentation string, when you need to refer to function arguments, names of classes, or other lisp objects, write these names in all uppercase, so that they are easy to find&rdquo;</p></blockquote>

<p>This was to help humans easily find them and because documentation generation tools could detect them.</p>

<p>Shouting the references in unstructured text made them clearly visible to both machines and humans.</p>

<h4>COBOL</h4>

<p>COBOL is another of those shouting languages which liked everything in uppercase. Which makes reading a COBOL program akin to having someone shout very loudly in your face. Until you cry. Lots.</p>

<p><img src="/images/blog/2012/11/image6-150x150.jpg" alt="" /></p>

<pre><code>01 RECORD-NAME.
02 DATA-NAME-1-ALPHA PIC X(2).
02 DATA-NAME-2.
03 DATA-NAME-3-NUMERIC PIC 99.
03 DATA-NAME-4.
04 DATA-NAME-5-ALPHA PIC X(2).
04 DATA-NAME-6-NUMERIC PIC 9(5).
02 DATA-NAME-7-ALPHA PIC X(6).
</code></pre>

<p>The only thing that was not upper case was comments.</p>

<blockquote><p>It helps if all comments are in lower-case, to differentiate from actual commands which should always be in upper-case</p></blockquote>

<p>Comments where not important, so no need to shout them. Which in turn makes them easier to read. Perhaps there is an understanding here that shouting makes code hard to read. Comments which might contain a lot of text should also be easier to read.</p>

<p>If you were still in doubt about COBOL&rsquo;s evilness: user defined constants were distinguished by using a <strong>single character variable name</strong>. MAD. YES THAT WAS WORTH SHOUTING.</p>

<h4>Basic</h4>

<p>In basic keywords were capitalised to distinguish between variables names. The case is insignificant, it&rsquo;s for the humans not the compiler.</p>

<pre><code>LET m = 2
LET a = 4
LET force = m*a
PRINT force
END
</code></pre>

<p>Keys words are important, so shout them. But in turn make it easier to read the user named variables by leaving them lower case.</p>

<h4>C</h4>

<p>C uses uppercase by convention for object-like Macros which get replaced during pre-processing.</p>

<pre><code>#define BUFFER_SIZE 1024
foo = (char *) malloc (BUFFER_SIZE);
</code></pre>

<p>Uppercase is used to defined a templating language within C, which we can quickly distinguish from the code. It also makes the job of the pre-processor easier, parsing macros.</p>

<h2>So is shouting a bad thing?</h2>

<p>When it comes to expressing ideas in nothing but text we use everything we can to provide structure and separation to help improve clarity. Shouting or uppercasing words provides a very powerful way of rapidly distinguishing certain aspects of text.</p>

<p>How programming languages spend this limited currency of instinctive separation reflects the languages understanding of readability (i&rsquo;m looking at you COBOL) and what they find to be important enough to earn shouting case.</p>

<p>However most modern languages provide you with the choice of shouting. In Ruby we can skip it all together.</p>

<p>Try not shouting for a while. See how it makes you feel.</p>

<p><img src="/images/blog/2012/11/shhh1-150x150.png" alt="" /></p>

<p>And always:</p>

<p>TRY AND AVOID SHOUTING FOR TOO LONG AS IT IS HARD TO READ.</p>

<p>Keep it <strong>sharp</strong>, <strong>short</strong> and <strong>loud</strong>.</p>

<h2>References</h2>

<p>[1] <a href="http://www.amazon.co.uk/gp/product/0962489158/ref=as_li_ss_tl?ie=UTF8&amp;camp=1634&amp;creative=19450&amp;creativeASIN=0962489158&amp;linkCode=as2&amp;tag=joswilblo-21">Type and Layout: How Topography and Design Can Get Your Message Across &ndash; Or get in the Way</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/ruby/recurrent-neural-networks-in-ruby.html">Recurrent Neural Networks in Ruby</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-10-29T14:00:30+00:00" pubdate data-updated="true">Oct 29<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>We look at how neural networks work, what is different about a recurrent networks and a library which allows us to use recurrent networks in Ruby (<a href="https://github.com/josephwilk/tlearn-rb">tlearn-rb</a>).</p>

<h2>What the heck is a Recurrent Network?</h2>

<p>First lets look briefly at how a neural network works:</p>

<h2>Neural Networks</h2>

<p>Neural networks use the model of neurones in the human brain. Put very simply the artifical neuron given some inputs (the dendrites) sums them to produce an output (the neuron&rsquo;s axon) which is usually passed through some non-linear function. The sum of the nodes is usually weighted.</p>

<p><img src="/images/blog/2012/10/image1.jpg" alt="" /></p>

<p>By taking a set of training data we can teach a neural network such that it can be applied to new data outside of the training set. For example we could have as inputs the states of a chess board and the output as a rank for how good the position is for white. We could after training, input an unseen board state and as output get a rank for how effective the position is for white.</p>

<p>As a neural network is trained it builds up the set of weights for the connections between nodes. Through many training iterations comparing expected outputs and the inputs these weights are built up.</p>

<h4>Feedforward Neural Network</h4>

<p><img src="/images/blog/2012/10/neural_network1.png" alt="" /></p>

<p>In some problems the order in which the inputs arrive at the network is important. A normal network fails at this as there is no explicit sense of the relationships between sets of inputs.</p>

<p>Lets consider an example. A network that is trained to detect how satisfying a word sounds to children.</p>

<p>We feed our network all the syllables of a word and get an output:</p>

<pre><code>["mon", "key"]
["o", "key", "do", "key"]
</code></pre>

<p>When we feed the syllable <em>&ldquo;key&rdquo; </em>into the neural network it will always return the same output irrelevant of what came before it. This misses a relationship between the syllables of the word.</p>

<p>A recurrent network aims to solve this problem by using both the input layer and the output layer to devise weights of the hidden layer.</p>

<h4>Recurrent Network</h4>

<p><img src="/images/blog/2012/10/recurrent_neural_network1.png" alt="" /></p>

<p>Going back to our example:</p>

<pre><code>["mon", "key"]
["o", "key", "do", "key"]
</code></pre>

<p>When we feed <em>&ldquo;key&rdquo;</em> into the neural network the weight returned will be effected by what the previous input was, [&ldquo;mon&rdquo;] or [&ldquo;o&rdquo;, &ldquo;key&rdquo;, &ldquo;do&rdquo;].</p>

<p>So our recurrent neural network would detect that &ldquo;o-key-do-key&rdquo; has a rhythm between the syllables that is appealing to children.</p>

<p>A recurrent network allows us to decided when to wipe the previous output and start again. So in our example we would reset the output layer after we have fed in all the syllables of the word. We are interested in the relationships between syllables of a word, not syllables of different words.</p>

<p><strong>So all this is a complicated way of saying Recurrent networks have state. Yes.</strong></p>

<h2>Recurrent Networks in Ruby</h2>

<p>There was no Ruby library that support Recurrent Networks. There was an <a href="http://leenissen.dk/fann/forum/viewtopic.php?t=47">attempt to add Recurrent networks</a> to <a href="http://leenissen.dk/fann/wp">FANN</a> (which has a <a href="http://ruby-fann.rubyforge.org/">ruby-fann gem</a> with bindings) but it was never merged in.</p>

<p>So I adapted the <a href="http://crl.ucsd.edu/innate/tlearn.html">TLearn C library</a> which supports Recurrent Neural Networks and wrapped it in Ruby Love.</p>

<p>It&rsquo;s having some trouble coming to terms with its new found rubyness, so there is a big alpha warning hanging on the door.</p>

<h3>Installing TLearn</h3>

<pre><code>gem install tlearn
</code></pre>

<h3>Using TLearn</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;tlearn&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">tlearn</span> <span class="o">=</span> <span class="ss">TLearn</span><span class="p">:</span><span class="ss">:Run</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">:number_of_nodes</span> <span class="o">=&gt;</span> <span class="mi">10</span><span class="p">,</span>
</span><span class='line'>                    <span class="ss">:&#39;output_nodes&#39;</span>    <span class="o">=&gt;</span> <span class="mi">5</span><span class="o">.</span><span class="n">.</span><span class="mi">6</span><span class="p">,</span>
</span><span class='line'>                    <span class="ss">:linear</span>          <span class="o">=&gt;</span> <span class="mi">7</span><span class="o">.</span><span class="n">.</span><span class="mi">10</span><span class="p">,</span>
</span><span class='line'>                    <span class="ss">:weight_limit</span>    <span class="o">=&gt;</span> <span class="mi">1</span><span class="o">.</span><span class="mo">00</span><span class="p">,</span>
</span><span class='line'>                    <span class="ss">:connections</span>     <span class="o">=&gt;</span> <span class="o">[</span><span class="p">{</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">6</span>   <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">},</span>
</span><span class='line'>                                         <span class="p">{</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">4</span>   <span class="o">=&gt;</span> <span class="ss">:i1</span><span class="o">.</span><span class="n">.</span><span class="ss">:i3</span><span class="p">},</span>
</span><span class='line'>                                         <span class="p">{</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">4</span>  <span class="o">=&gt;</span> <span class="mi">7</span><span class="o">.</span><span class="n">.</span><span class="mi">10</span><span class="p">},</span>
</span><span class='line'>                                         <span class="p">{</span><span class="mi">5</span><span class="o">.</span><span class="n">.</span><span class="mi">6</span>   <span class="o">=&gt;</span> <span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">4</span><span class="p">},</span>
</span><span class='line'>                                         <span class="p">{</span><span class="mi">7</span><span class="o">.</span><span class="n">.</span><span class="mi">10</span>  <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">4</span><span class="p">,</span> <span class="p">{</span><span class="ss">:min</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="ss">:max</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span><span class="p">},</span> <span class="ss">:fixed</span><span class="p">,</span> <span class="ss">:&#39;one_to_one&#39;</span><span class="p">}</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'><span class="n">training_data</span> <span class="o">=</span> <span class="o">[</span><span class="p">{</span><span class="o">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="o">]</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">]</span><span class="p">}</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>                 <span class="o">[</span><span class="p">{</span><span class="o">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">]</span>  <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="o">]</span><span class="p">}</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'><span class="n">tlearn</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">sweeps</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">tlearn</span><span class="o">.</span><span class="n">fitness</span><span class="p">(</span><span class="o">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">]</span><span class="p">,</span> <span class="n">sweeps</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
</span><span class='line'><span class="c1"># =&gt; [0.2, 0.9]</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Wait! What does that output mean?</h3>

<p>In our example we had 2 outputs. The result we get from running the fitness test are the final weights:</p>

<pre><code>[0.2, 0.9]
</code></pre>

<p>In this example we can think of the first output as rank 1, and the second output as rank 2. We look at which has the highest weighting in the fitness test, In this case it shows us that the input &ldquo;000&rdquo; has rank 2. So really we can map the output to many different classifications.</p>

<h3>How is state reset?</h3>

<p>Tlearn resets the state for each list of elements</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[</span><span class="p">{</span><span class="o">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="o">]</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">]</span><span class="p">},</span> <span class="p">{</span><span class="o">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="o">]</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">]</span><span class="p">}</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'><span class="c1"># State will be reset here</span>
</span><span class='line'><span class="o">[</span><span class="p">{</span><span class="o">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">]</span>  <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="o">]</span><span class="p">}</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Wait! What the heck does all that config mean?</h3>

<p>Part of the work of using Neural networks is finding the right configuration settings. TLearn supports a lot of different options. Lets look at what all that  configuration options means. (Checkout the <a href="https://github.com/josephwilk/tlearn-rb#configuring-tlearn-what-the-heck-does-all-that-config-mean">TLearn Github Readme</a> for full details of the config options):</p>

<pre><code>:number_of_nodes =&gt; 10
</code></pre>

<p>The total number of nodes in this network (not including input nodes)</p>

<pre><code>:'output_nodes'    =&gt; 5..6
</code></pre>

<p>Which nodes are used for output.</p>

<pre><code>:linear          =&gt; 7..10
</code></pre>

<p>Nodes 7 to 10 are linear. This defines the activation function of the nodes. The activation function is how all the weights and input are combined for a node to create an output. Linear nodes output the inner-product of the input and weight vectors.</p>

<pre><code>:weight_limit    =&gt; 1.00
</code></pre>

<p>Limit of 1.0 must not be exceeded in the random initialization of weights.</p>

<h4>Connections</h4>

<p>Connections specify how all the nodes of the neural network connect. This is the architecture of the neural network. Lets look at the connection settings:</p>

<pre><code>{1..6   =&gt; 0}
</code></pre>

<p>Node 0 feeds into node 1 to 6. Node 0 is the bias node that is always 1.</p>

<p><img src="/images/blog/2012/10/bias_node.png" alt="" /></p>

<pre><code> {1..4   =&gt; :i1..:i3}
</code></pre>

<p>The input nodes 1-3 feed into each node from 1 to 4.
<img src="/images/blog/2012/10/inputs1.png" alt="" /></p>

<pre><code>{1..4  =&gt; 7..10},
</code></pre>

<p>Nodes nodes 7-10 feed into each node from 1 to 4
<img src="/images/blog/2012/10/outout.png" alt="" /></p>

<pre><code>{5..6   =&gt; 1..4},
</code></pre>

<p>Nodes nodes 1..4 feed into each node from 5 to 6
<img src="/images/blog/2012/10/outes.png" alt="" /></p>

<pre><code> {7..10  =&gt; [1..4, {:min =&gt; 1.0, :max =&gt; 1.0}, :fixed, :'one_to_one'}]
</code></pre>

<p>This connection contains a couple of special options. Rather than node 1-4 being fed into node 7, node 1 only connects with node 7, node 2 only with node 8, node 3 only with node 9, node 4 only with node 10. The <em>:&lsquo;one_to_one&rsquo;</em> option causes this.
The weights of the connections between these nodes is <em>fixed</em> at 1.0 and never changes throughout training</p>

<p><img src="/images/blog/2012/10/ins.png" alt="" /></p>

<p>So put all these together our full neural network is:</p>

<p><img src="/images/blog/2012/10/network-out1.png" alt="" /></p>

<h3>Urmm&hellip; So how do I know what connection settings to use?</h3>

<p>When it comes to deciding how many hidden nodes to have in your network there is a general rule:</p>

<blockquote><p>The optimal number of hidden nodes is usually between the size of the input and size of the output layers</p></blockquote>

<p>When deciding what connections to specify in your neural network you can start with everything connected to everything and slowly experiment with pruning connections/nodes which will increase the performance of your network without radically affecting the output efficiency.</p>

<p>Its important to have the bias node connect to all the nodes in the hidden layer and output. This is required so a zero input to the neural network can generate outputs other than 0.</p>

<p>With recurrent networks it is important to build connections and nodes in your network to maintain state. It is quite possible with TLearn to build a plain old neural network with no state.  It can be helpful like the example given above to draw out your state, hidden layer and output layer nodes and use this to decided how the network connects.</p>

<p>How do you decide what activation functions to use? Linear, bipolar, etc.
Checkout this great paper on the effectiveness of different functions: <a href="http://www.cscjournals.org/csc/manuscript/Journals/IJAE/volume1/Issue4/IJAE-26.pdf">http://www.cscjournals.org/csc/manuscript/Journals/IJAE/volume1/Issue4/IJAE-26.pdf</a></p>

<p>One neat (crazy) experimental (crazy) path to explore is neural network toplogies generated from using a genetic algorithm to assess the effectiveness of the network: <a href="http://www.cs.ucf.edu/~kstanley/neat.html">http://www.cs.ucf.edu/~kstanley/neat.html</a>.</p>

<h3>TLearn&rsquo;s Source</h3>

<p>If you want to peer into the heart of TLearn the source code is on Github:</p>

<pre><code>git clone git://github.com/josephwilk/tlearn-rb.git
</code></pre>

<h3>Further reading</h3>

<ul>
<li><a href="http://www.amazon.co.uk/gp/product/B00845UQL6/ref=as_li_ss_tl?ie=UTF8&amp;camp=1634&amp;creative=19450&amp;creativeASIN=B00845UQL6&amp;linkCode=as2&amp;tag=joswilblo-21">Introduction to the Math of Neural Networks</a><img src="http://www.assoc-amazon.co.uk/e/ir?t=joswilblo-21&amp;l=as2&amp;o=2&amp;a=B00845UQL6" alt="" /></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/presentations/someone-is-wrong.html">Someone Is Wrong</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-09-07T23:35:45+01:00" pubdate data-updated="true">Sep 7<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Understanding Rhetoric is an essential skill for any programmer.</p>

<p>Here is my introduction talk &ldquo;Someone is wrong&rdquo;, rhetoric for programmers.</p>

<p><a href="http://programme.scottishrubyconference.com/proposals/144/video">Video from Scottish Ruby conference</a></p>

<h2>Slides</h2>

<script async class="speakerdeck-embed" data-id="4ff1e7144b8be00184011461" data-ratio="1.33333333333333" src="//speakerdeck.com/assets/embed.js"></script>


<h2>Further Reading</h2>

<ul>
<li><p><a href="http://www.amazon.co.uk/gp/product/0141032588/ref=as_li_tf_tl?ie=UTF8&amp;camp=1634&amp;creative=6738&amp;creativeASIN=0141032588&amp;linkCode=as2&amp;tag=joswilblo-21">Winning Arguments: From Aristotle to Obama &ndash; Everything You Need to Know About the Art of Persuasion</a><img src="http://www.assoc-amazon.co.uk/e/ir?t=joswilblo-21&amp;l=as2&amp;o=2&amp;a=0141032588" alt="" /></p></li>
<li><p><a href="http://www.informationisbeautiful.net/visualizations/rhetological-fallacies">Rhetological Fallacies</a></p></li>
</ul>


<h2>What people said about this talk</h2>

<p><img src="/images/blog/2012/09/what_they_said_double.png" alt="" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/ruby/fake-execution.html">Fake Execution</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-08-30T17:51:07+01:00" pubdate data-updated="true">Aug 30<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A little RubyGem for faking out execution in your tests and inspecting afterwards what was run.</p>

<h2>Why FakeExecution?</h2>

<p>I&rsquo;ve been creating internal tools for developers to help improve productivity. These tools written in Ruby, ended up doing lots of shell scripting. These scripts started becoming fairly complicated so I wanted some test feedback. How could I easily test execution?</p>

<p>Enter FakeExecution.</p>

<h2>Installing</h2>

<pre><code>gem install fake_execution
</code></pre>

<h2>How do I use it?</h2>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;fake_execution/safe&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="no">FakeExecution</span><span class="o">.</span><span class="n">activate!</span>
</span><span class='line'>
</span><span class='line'><span class="sb">`echo *`</span> <span class="c1"># This is not executed</span>
</span><span class='line'>
</span><span class='line'><span class="sb">`git checkout git://github.com/josephwilk/fake-execution.git`</span>
</span><span class='line'><span class="sb">`touch monkeys`</span>
</span><span class='line'><span class="nb">system</span><span class="p">(</span><span class="s2">&quot;git add monkeys&quot;</span><span class="p">)</span>
</span><span class='line'><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;git commit -m &quot;needs more monkeys&quot;&#39;</span><span class="p">)</span>
</span><span class='line'><span class="sb">`git push`</span>
</span><span class='line'>
</span><span class='line'><span class="no">FakeExecution</span><span class="o">.</span><span class="n">deactivate!</span>
</span><span class='line'>
</span><span class='line'><span class="n">cmds</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">should</span> <span class="o">=~</span> <span class="sr">/echo/</span>
</span><span class='line'><span class="n">cmds</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="n">should</span> <span class="o">=~</span> <span class="sr">/git checkout/</span>
</span><span class='line'><span class="n">cmds</span><span class="o">[</span><span class="mi">2</span><span class="o">].</span><span class="n">should</span> <span class="o">==</span> <span class="s1">&#39;touch monkeys&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="sb">`echo *`</span> <span class="c1"># outputs: echo *</span>
</span></code></pre></td></tr></table></div></figure>


<h2>But I use Rspec</h2>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'> <span class="nb">require</span> <span class="s1">&#39;fake_execution/spec_helper&#39;</span>
</span><span class='line'>
</span><span class='line'> <span class="n">describe</span> <span class="s2">&quot;monkeys&quot;</span> <span class="k">do</span>
</span><span class='line'>   <span class="kp">include</span> <span class="ss">FakeExecution</span><span class="p">:</span><span class="ss">:SpecHelpers</span>
</span><span class='line'>
</span><span class='line'>   <span class="n">it</span> <span class="s2">&quot;should touch the monkey&quot;</span> <span class="k">do</span>
</span><span class='line'>     <span class="sb">`touch monkey`</span>
</span><span class='line'>
</span><span class='line'>     <span class="n">cmds</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">should</span> <span class="o">==</span> <span class="s1">&#39;touch monkey&#39;</span>
</span><span class='line'>   <span class="k">end</span>
</span><span class='line'> <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Source code</h2>

<p><a href="http://github.com/josephwilk/fake_execution">http://github.com/josephwilk/fake_execution</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/conferences/conferences-and-the-cult-of-celebrity.html">Conferences and the Cult of Celebrity</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-19T13:58:56+01:00" pubdate data-updated="true">Jun 19<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>How much should character be a factor for a conference talk being selected?  Big names sell conference tickets. Yet I believe that we can do a lot more to help promote conferences where content takes greater weight than character and in the process help people who have never spoken before start speaking at conferences.</p>

<h2>Risk.</h2>

<p>Conference organisers take a big risk running a conference.</p>

<p>Will they cover their venue cost?</p>

<p>Which ultimately leads on to will they sell enough tickets?</p>

<p>Once they have enough tickets, will it be a good conference?</p>

<p>Other successful conferences define a pattern of how a conference is laid out. One obviously way of dealing with Risk is to follow an example of a success.</p>

<p>I really respect people who organise conferences, they are putting a lot of effort and their own time to make a successful event.</p>

<p>But I wondering if maybe we could be focusing more on content and less on character.</p>

<h2>Selling a presentation</h2>

<p>When you submit a talk an aspect of convincing the organisers to allow you to talk is who you are. Persuasion by character (Ethos if you like your ancient Greek).</p>

<p>Most submissions forms give you plenty of space to sell yourself.</p>

<p><img src="/images/blog/2012/06/example_submission.png" alt="" /></p>

<h2>Content not character.</h2>

<p><img src="/images/blog/2012/06/nordicruby1.png" alt="" /></p>

<p>For NordicRuby 2012 the organisers took a step pushing for interesting content over character. They recognised that conscious and subconscious persuasion by character is a powerful means of convincing.</p>

<p>During most of their reviewing process <strong>they removed all the names from the proposals</strong>.</p>

<blockquote><p><em>&ldquo;Another thing we’re doing differently this year is that we’re starting out with anonymous proposals. Each card in Trello just shows the proposal’s title and description. No information about the speaker. We do this to avoid bias in the first stages.&rdquo;</em></p></blockquote>

<p>Talks where selected based on the content. Only later once the talks had been whittled down did they introduce the speaker names. Character was considered, it was just delayed to the late selection stage.</p>

<p>This tweet caught my attention as it highlighted that for Jsconf.com.au proposals are selected without names attached. Content is king, character does not matter!</p>

<p><img src="/images/blog/2012/06/tweet.png" alt="" /></p>

<p>Lonestar Ruby conference submissions, your name, your email, no big bio to sell how great you are. Content rules.</p>

<p><img src="/images/blog/2012/06/logo-adjusted-7293a1d3bfb1dac006dd14619c2efe07.png" alt="" /></p>

<p><img src="/images/blog/2012/06/Screen-Shot-2012-06-18-at-13.53.08.png" alt="" /></p>

<h2>Keynotes: where character is King</h2>

<p>The keynote of a conference is the stable diet of most conferences. Its where the big names are rolled out, luminaries of our industry share their wise thoughts with us.</p>

<p>Akin to live music, they are the headline act we pay for, the others are the  support acts. We might skip them, or give them half of our attention.</p>

<p><strong>What effect does having two tiers of talks at a conference have?</strong></p>

<p>The keynote talk is more important irrelevant of content because of the <strong>character of the speaker</strong>. Often we don&rsquo;t even know what they will be talking about, just that they are keynoting.</p>

<p>Some examples (I&rsquo;m not focusing any blame on these examples, I respect the conferences and the organisers involved. They just help illustrate my point)</p>

<p><img src="/images/blog/2012/06/Screen-Shot-2012-06-19-at-13.11.59.png" alt="" /></p>

<p><a href="/images/blog/2012/06/Screen-Shot-2012-06-18-at-14.23.55.png"><img src="/images/blog/2012/06/Screen-Shot-2012-06-18-at-14.23.55.png" alt="" /></a></p>

<p>We assume (based on authority) that important people will have important things to tell us (and sometimes they do have important ideas to share with us).</p>

<p>Are the other, non-keynote talks of the conference of lesser importance? This is where content starts to win because all these speakers are non-keynoters, we don&rsquo;t have as many leading assumptions about their authority or character. <strong>We go to the talks where the content interests us.</strong></p>

<p>Maybe all talks should be driven by the <strong>content</strong> and less by <strong>character</strong>. Maybe all talks are as important as each other.</p>

<p>Conferences are already starting to kill of this idea of having to have a Keynote to sell your conference. FutureRuby and NordicRuby are two examples of conferences that have no Keynote yet produced conferences that are highly regarded by those who attended.</p>

<p><strong>Will a keynote really make your conference better?</strong></p>

<h2>The Content Conference</h2>

<p>Lets see if we can take this a step further and define the content conference.</p>

<ol>
<li><p>Talks authors are not revealed during review/selection. (There is <strong>no bias by character</strong>)</p></li>
<li><p>Only publish the talk titles and content on the conference website. (Sell the conference on its <strong>content not its characters</strong>.)</p></li>
<li><p>No keynotes. <strong>All talks are equal</strong>.</p></li>
</ol>


<h2>Conference Mentors</h2>

<p>If we want to focus on content and remove character (as much as possible) we have to deal with people with little experience but with great ideas. We need to help make it easier to give feedback and help mentor those people so they can best express their ideas.</p>

<p><strong>Being accepted to speak is not the end of contact its the start</strong>.</p>

<p>A group of experience speakers acting as mentors who give feedback and help people give the best presentations they can.</p>

<h2>Final Words</h2>

<p>There is a place in the conference world for events which focus on bringing big names to an audience. Looking back at the 30 conferences I&rsquo;ve spoken at so far I&rsquo;ve come to the conclusion that the conferences I really valued where those that pushed for content over character. Conferences are popping up all the time that follow the content conference ideas and <strong>understand the concious and subconsious bias of character</strong>.</p>

<p>I feel if we try and push for content over character and improve the proposal/speaker setup we can help find new people with great, interesting, crazy ideas and encourage them to submit proposals and speak.</p>

<p>I hope these ideas about the content conference might help conference organisers think about how they structure their conference and proposal system.</p>

<p><strong>I am offering my time to mentor anyone who wants help writing their first conference proposal</strong>.</p>

<p>I am also happy to join any conference that wants a set of experienced speakers to help new speakers get the best out of their presentations.</p>

<p>Crazy, huh?</p>

<p>So what do you think?</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/big-data/a-little-bit-of-pig.html">A Little Bit of Pig</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-11T17:35:41+01:00" pubdate data-updated="true">Jun 11<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Currently in the Science team at Songkick I&rsquo;ve been working with Apache Pig to generate lots of interesting metrics for our business intelligence. We use Amazon&rsquo;s MapReduce and Pig to avoid having to run complex, long running and intensive queries on our live db, we can run them on Amazon in a timely fashion instead. So lets dive into Pig and how we use it at Songkick.com.</p>

<h2>Pig (whats with all these silly names)</h2>

<p>The Apache project Pig is a data flow language designed for analysing large datasets. It provides a high-level platform for creating MapReduce programs used with <em>Hadoop. </em>A little bit like SQL but Pig&rsquo;s programs by their structure are suitable for <strong>parallelization</strong>, which is why they are great at  handling very large data sets.</p>

<p><img src="/images/blog/2012/05/pig-300x284.gif" alt="" /></p>

<p>Heres how we use Pig and ElasticMapReduce at Songkick in our Science team.</p>

<h2>Data (Pig food)</h2>

<p><img src="/images/blog/2012/06/pig_eating.png" alt="" /></p>

<p>Lets start by uploading some huge and interesting data about Songkicks artists onto S3. We start by dumping a table from mysql (along with a lot of other tables) and then query that data with Pig on Hadoop. While we could extract all the artist data by querying the live table its actually faster to use mysqldump and dump the table as a TSV file.</p>

<p>For example it took 35 minutes to dump our artist table with a sql query &lsquo;select * from artists&rsquo;. It takes 10 minutes to dump the entire table with mysqldump.</p>

<p>We format the table dump as a TSV which we push to S3 as that makes it super easy to use Amazons ElasticMapReduce with Pig.</p>

<pre><code>shell&gt; mysqldump --user=joe --password  --fields-optionally-enclosed-by='"'
                  --fields-terminated-by='\t' --tab /tmp/path_to_dump/ songkick artist_trackings
</code></pre>

<p>Unfortunately this has to be run on the db machine since mysqldump needs access to the file system to save the data. If this is a problem for you there is a Ruby script for dumping tables to TSV: <a href="http://github.com/apeckham/mysqltsvdump/blob/master/mysqltsvdump.rb">http://github.com/apeckham/mysqltsvdump/blob/master/mysqltsvdump.rb</a></p>

<h2>Launching (Pig catapult)</h2>

<p><img src="/images/blog/2012/06/flying_pig.png" alt="" /></p>

<p>We will be using Amazons Elastic MapReduce to run our Pig scripts. We can start our job in interactive Pig mode which allows us to ssh to the box and run the pig script line by line.</p>

<p><img src="/images/blog/2012/05/aws_pig.png" alt="" /></p>

<h2>Examples (Dancing Pigs)</h2>

<p><img src="/images/blog/2012/06/dancing_pigs1.jpg" alt="" /></p>

<p>An important thing to note when running pig scripts interactively is that they defer execution until they have to expose a result. This means you can get nice schema checks and validations helping ensure your PIG script is valid without actually executing it over your large dataset.</p>

<p>We are going to try and calculate the average number of users tracking an artist based on the condition that we only count users who logged in, in the last 30 days.</p>

<p>This is what our Pig script is doing:</p>

<p><img src="/images/blog/2012/06/query6.png" alt="" /></p>

<p>The Pig script:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-- Define some useful dates we will use later
</span><span class='line'>%default TODAYS_DATE `date  +%Y/%m/%d`
</span><span class='line'>%default 30_DAYS_AGO `date -d "$TODAYS_DATE - 30 day" +%Y-%m-%d`
</span><span class='line'>    
</span><span class='line'>-- Pig is smart enough when given a folder to go and find files, decompress them if necessarily and load them.
</span><span class='line'>-- Note we have to specify the schema as PIG does not know know this from our TSV file.
</span><span class='line'>trackings = LOAD 's3://songkick/db/trackings/$TODAYS_DATE/' AS (id:int, artist_id:int,  user_id:int); 
</span><span class='line'>users = LOAD 's3://songkick/db/users/$TODAYS_DATE/' AS (id:int, username:chararray, last_logged_in_at:chararray);</span></code></pre></td></tr></table></div></figure>


<pre><code>trackings
&lt;1, 1, 1&gt;
&lt;2, 1, 2&gt;

users
&lt;1,'josephwilk', '11/06/2012'&gt;
&lt;2,'elisehuard', '11/06/2012'&gt;
&lt;3,'tycho', '11/06/2010'&gt;
</code></pre>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-- Filter users to only those who logged in, in the last 30 days
</span><span class='line'>    -- Pig does not understand dates, so just treat them as strings
</span><span class='line'>    active_users = FILTER users by last_logged_in_at gte '$30_DAYS_AGO'</span></code></pre></td></tr></table></div></figure>


<pre><code>Users
&lt;1,'josephwilk', '11/06/2012'&gt;
&lt;2,'elisehuard', '11/06/2012'&gt;
</code></pre>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>active_users_and_trackings = JOIN active_users BY id, trackings BY user_id
</span><span class='line'>    
</span><span class='line'>    -- group all the users tracking an artists so we can count them.
</span><span class='line'>    active_users_and_trackings_grouped = GROUP active_users_and_trackings BY active_users::user_id;</span></code></pre></td></tr></table></div></figure>


<pre><code>&lt;1, 1, /\{&lt;1,'josephwilk', '11/06/2012'&gt;, &lt;2,'elisehuard', '11/06/2012'&gt;\/}&gt;`
</code></pre>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>trackings_per_artist = FOREACH active_users_and_trackings_grouped GENERATE group, COUNT($2) as number_of_trackings;</span></code></pre></td></tr></table></div></figure>


<pre><code>`&lt;\/{&lt;1,'josephwilk', '11/06/2012'&gt;, &lt;2,'elisehuard', '11/06/2012'&gt;\/}, 2&gt;`
</code></pre>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-- group all the counts so we can calculate the average
</span><span class='line'>    all_trackings_per_artist = GROUP trackings_per_artist ALL;</span></code></pre></td></tr></table></div></figure>


<pre><code>&lt;\/{\/{&lt;1,'josephwilk', '11/06/2012'&gt;, &lt;2,'elisehuard', '11/06/2012'&gt;\/}, 2\/}&gt;
</code></pre>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-- Calculate the average
</span><span class='line'>    average_artist_trackings_per_active_user = FOREACH all_trackings_per_artist
</span><span class='line'>      GENERATE '$DATE' as dt, AVG(trackings_per_artist.number_of_trackings);</span></code></pre></td></tr></table></div></figure>


<pre><code>&lt;{&lt;'11/062012', 2&gt;}&gt;
</code></pre>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>--Now we have done the work store the result in S3.
</span><span class='line'>    STORE average_artist_trackings_per_active_user INTO
</span><span class='line'>      's3://songkick/stats/average_artist_trackings_per_active_user/$TODAYS_DATE'</span></code></pre></td></tr></table></div></figure>


<h2>Debugging Pigs (Pig autopsy)</h2>

<p><img src="/images/blog/2012/06/pig_insides.png" alt="" />
In an interactive pig session there are two useful commands for debugging:
<strong>DESCRIBE</strong> to see the schema.
<strong>ILLUSTRATE</strong> to see the schema with sample data:</p>

<pre><code>DESCRIBE users;
users: {id:int, username:chararray, created_at:chararray, trackings:int}

ILLUSTRATE users;
----------------------------------------------------------------------
| users   | id: int | username:chararray | created_at | trackings:int |
----------------------------------------------------------------------
|         | 18      | Joe                | 10/10/13   | 1000          |
|         | 20      | Elise              | 10/10/14   | 2300          |
----------------------------------------------------------------------
</code></pre>

<h2>Automating Elastic MapReduce (Pig robots)</h2>

<p><img src="/images/blog/2012/06/pig_robot.png" alt="" /></p>

<p>Once you are happy with your script you&rsquo;ll want to automate all of this. I currently do this by having a cron task which at regular intervals uses the  elastic-mapreduce-ruby lib to fire up a elastic map reduce job and run it with the pig script to execute.</p>

<p>Its important to note that I <em>store the pig scripts on S3</em> so its easy for elastic-mapreduce to find the scripts.</p>

<p>Follow the instructions to install elastic-mapreduce-ruby: <a href="https://github.com/tc/elastic-mapreduce-ruby">https://github.com/tc/elastic-mapreduce-ruby</a></p>

<p>To avoid having to call elastic-mapreduce with 100s of arguments a colleague has written a little python wrapper to make it quick and easy to use: <a href="https://gist.github.com/2911006">https://gist.github.com/2911006</a></p>

<p>You&rsquo;ll need to configure where you&rsquo;re elastic-mapreduce tool is installed AND where you want elastic map-reduce to log to on S3 (this means you can debug your elastic map reduce job if things go wrong!).</p>

<p>Now all we need to do is pass the script the path to the pig script on S3.</p>

<pre><code>./emrjob s3://songkick/lib/stats/pig/average_artist_trackings_per_active_user.pig
</code></pre>

<h2>Testing with PigUnit (Simulating Pigs)</h2>

<p><img src="/images/blog/2012/06/virtual_pig.png" alt="" /></p>

<p>Pig scripts can still take a long time to run even with all that Hadoop magic. Thankfully there is a testing framework PigUnit.</p>

<p><a href="http://pig.apache.org/docs/r0.8.1/pigunit.html#Overview">http://pig.apache.org/docs/r0.8.1/pigunit.html#Overview</a></p>

<p>Unfortunately this is where you have to step into writing Java. So I skipped it. Sshhh.</p>

<h2>References</h2>

<ol>
<li><p> Apache Pig official site: <a href="http://pig.apache.org/">http://pig.apache.org</a></p></li>
<li><p> Nearest Neighbours with Apache Pig and JRuby: <a href="http://thedatachef.blogspot.co.uk/2011/10/nearest-neighbors-with-apache-pig-and.html">http://thedatachef.blogspot.co.uk/2011/10/nearest-neighbors-with-apache-pig-and.html </a></p></li>
<li><p> Helpers for messing with Elastic MapReduce in Ruby <a href="https://github.com/tc/elastic-mapreduce-ruby">https://github.com/tc/elastic-mapreduce-ruby</a></p></li>
<li><p> mysqltsvdump <a href="http://github.com/apeckham/mysqltsvdump/blob/master/mysqltsvdump.rb">http://github.com/apeckham/mysqltsvdump/blob/master/mysqltsvdump.rb</a></p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/cucumber/examples-are-not-a-specification.html">Examples Alone Are Not a Specification</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-02-24T14:25:30+00:00" pubdate data-updated="true">Feb 24<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The Gherkin syntax used by Cucumber enforces that Feature files contain scenarios which are examples of the behaviour of a feature. However Gherkin has no constraints on if there is a specification present. Examples are great at helping us understand specifications but <strong>they are not specifications themselves</strong>.</p>

<p>What do we mean when we say specification?</p>

<p><em>definition: A detailed, exact statement of particulars</em></p>

<p>In a Gherkin feature the specification lives here:</p>

<p><img src="/images/blog/2012/02/spec7.png" alt="" /></p>

<p>Lets look at a real example:</p>

<h2>A Feature with just Examples</h2>

<p>A Cucumber example based on a feature  (which I have modified) from the test library Rspec <a href="https://github.com/rspec/rspec-expectations">rspec-expectations</a>:</p>

<pre><code>Feature: be_within matcher
  Scenario: basic usage
  Given a file named "be_within_matcher_spec.rb" with:
  """
  describe 27.5 do
  it { should be_within(0.5).of(27.9) }
  it { should be_within(0.5).of(27.1) }
  it { should_not be_within(0.5).of(28) }
  it { should_not be_within(0.5).of(27) }
  # deliberate failures
  it { should_not be_within(0.5).of(27.9) }
  it { should_not be_within(0.5).of(27.1) }
  it { should be_within(0.5).of(28) }
  it { should be_within(0.5).of(27) }
  end
  """
  When I run `rspec be_within_matcher_spec.rb`
  Then the output should contain all of these:
  | 8 examples, 4 failures                     |
  | expected 27.5 not to be within 0.5 of 27.9 |
  | expected 27.5 not to be within 0.5 of 27.1 |
  | expected 27.5 to be within 0.5 of 28       |
  | expected 27.5 to be within 0.5 of 27       |
</code></pre>

<p>So where is the explanation of what <em>be_within</em> does? If I want to know how <em>be_within</em> works I want a single concise explanation not 5/6 different examples. Examples add value later to validate that specification.</p>

<h2>A Feature with both Specification and Examples</h2>

<p>Lets add back in the specification part of the Feature. <em>drum roll</em></p>

<pre><code>Feature: be_within matcher

  Normal equality expectations do not work well for floating point values.
  Consider this irb session:

      &gt; radius = 3
        =&gt; 3 
      &gt; area_of_circle = radius * radius * Math::PI
        =&gt; 28.2743338823081 
      &gt; area_of_circle == 28.2743338823081
        =&gt; false 

  Instead, you should use the be_within matcher to check that the value
  is within a delta of your expected value:

      area_of_circle.should be_within(0.1).of(28.3)

  Note that the difference between the actual and expected values must be
  smaller than your delta; if it is equal, the matcher will fail.

  Scenario: basic usage
    Given a file named "be_within_matcher_spec.rb" with:
      """
      describe 27.5 do
        it { should be_within(0.5).of(27.9) }
        it { should be_within(0.5).of(27.1) }
        it { should_not be_within(0.5).of(28) }
        it { should_not be_within(0.5).of(27) }

        # deliberate failures
        it { should_not be_within(0.5).of(27.9) }
        it { should_not be_within(0.5).of(27.1) }
        it { should be_within(0.5).of(28) }
        it { should be_within(0.5).of(27) }
      end
      """
    When I run `rspec be_within_matcher_spec.rb`
    Then the output should contain all of these:
      | 8 examples, 4 failures                     |
      | expected 27.5 not to be within 0.5 of 27.9 |
      | expected 27.5 not to be within 0.5 of 27.1 |
      | expected 27.5 to be within 0.5 of 28       |
      | expected 27.5 to be within 0.5 of 27       |
</code></pre>

<p>Thats better, we can get an explanation of why this method exists and how to use it.</p>

<h2>Imagine RSpec without the specification</h2>

<p>I think of a Cucumber feature without a specification much like an Rspec example without any English sentence/description.</p>

<pre><code>context "" do
  it "" do
    user = Factory(:user)
    user.generate_password
    user.activate

    get "/session/new", :user_id =&gt; user.id

    last_response.should == "Welcome #{user.name}"
  end
end
</code></pre>

<p>Feels a little odd doesn&rsquo;t it.</p>

<h2>Cucumber Features as Documentation (for real)</h2>

<p>Rspec is an example of a project that has taken its Cucumber features and <a href="https://www.relishapp.com/rspec">published them as its documentation</a>. Just browse through those features and it quickly highlights how important it is to have a specification as well as examples. Imagine an API with nothing but examples, leaving you the detective work of trying to work out what the thing actually does.</p>

<p>Documentation needs to explain/specify what something does as well provide examples. If you really want anyone to read your feature provide both examples and a specification.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/testing/co-chair-of-the-agile-alliance-functional-testing-tools-group.html">Co-chair of the Agile Alliance Functional Testing Tools Group</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-02-13T18:40:27+00:00" pubdate data-updated="true">Feb 13<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;m happy to announce that I have joined <a href="http://testobsessed.com">Elizabeth Hendrickson</a> as Co-Chair of the Agile Alliance Functional Testing Tools group (AAFTT, yes the name is a bit of a mouthful).</p>

<p>I came across the AAFTT group when they organised a pattern writing workshop in London 2010, facilitated by <a href="http://www.lindarising.org/">Linda Rising</a>. It was an opportunity to bringing together some of the thought leaders in testing and share experiences. Somehow I managed to sneak in and proceded to steal all these experts knowledge. The AAFTT also runs an open space pria to the Agile conference. Last year I was surprised to find people who had travelled to the conference just for the AAFTT open space!</p>

<p>As a developer who loves messing around with testing tools, I’ll happily admit I know little about testing as a profession. The scope and breath of ideas that the AAFTT exposed me to has left me excited and hungry to play with new tools, ideas and patterns to make testing as fun as it should be. I hope as a developer who is obsessed about testing I can help blur the lines between developers and testers. I’m both.</p>

<p>Want to know more about the Agile Alliance Functional Testing Tools group?</p>

<ul>
<li><p>Mailing list: <a href="http://tech.groups.yahoo.com/group/aa-ftt/">http://tech.groups.yahoo.com/group/aa-ftt/</a></p></li>
<li><p>AAFTT workshop 2009, Chicago <a href="http://cds43.wordpress.com/2009/10/06/aaftt-workshop-2009-chicago/">http://cds43.wordpress.com/2009/10/06/aaftt-workshop-2009-chicago/</a></p></li>
<li><p>Records from previous AAFTT workshops: <a href="http://www.managing-expectations.com">http://www.managing-expectations.com</a></p></li>
</ul>


<p>And keep your ears open for any events!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/cucumber/mining-cucumber-features.html">Mining Cucumber Features</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-07-26T18:00:23+01:00" pubdate data-updated="true">Jul 26<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Failure Rates vs Change Rates</h2>

<p>I&rsquo;ve been spending a lot of  time recently data mining our test suite at Songkick.com. I&rsquo;ve been using our own internal version of <a href="http://www.limited-red.com">www.limited-red.com</a> which records all our test fails for every build on our continuous integration server.</p>

<p>With the Cucumber features I decided to plot the number of times a feature file has been significantly changed vs the number of times the feature has failed in the build. The theory being that a change to a feature file(the plain text specification of behaviour) most often represents a chance in functionality.</p>

<p>So I wrote a simple script checking the number of commits to each feature file.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">features_folder</span> <span class="o">=</span> <span class="no">ARGV</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
</span><span class='line'><span class="n">feature_files</span> <span class="o">=</span> <span class="no">Dir</span><span class="o">[</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">features_folder</span><span class="si">}</span><span class="s2">/**/*.feature&quot;</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'><span class="n">feature_files</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">feature_file</span><span class="o">|</span>
</span><span class='line'>  <span class="n">change_logs</span> <span class="o">=</span> <span class="sb">`git log --oneline </span><span class="si">#{</span><span class="n">feature_file</span><span class="si">}</span><span class="sb"> 2&gt;/dev/null`</span>
</span><span class='line'>  <span class="n">change_count</span> <span class="o">=</span> <span class="n">change_logs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">feature_file</span><span class="si">}</span><span class="s2">,</span><span class="si">#{</span><span class="n">change_count</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Feature changes compared with feature failures</h2>

<p>Throwing that into a pretty graph, here is a snapshot of some of the features (I&rsquo;ve changed the name of the features to hide top secret Songkick business).</p>

<p><img src="/images/blog/2011/07/feature_change_vs_failure1.png" alt="" /></p>

<h3>Insights</h3>

<p>Based on this I identified two possible groups of features:</p>

<ul>
<li><p>Features failing more often than the code around them is changing</p></li>
<li><p>Features which are robust and are not breaking when the code around them is changing.</p></li>
</ul>


<p>Further investigation into the suspect features highlighted 3 causes:</p>

<ul>
<li><p>Brittle step definitions</p></li>
<li><p>Brittle features coupled to the UI</p></li>
<li><p>Tests with a high dependency on asynchronous behaviour</p></li>
</ul>


<h2>Holes in the data &ndash; step definitions</h2>

<p>We only recorded the change rate of features files in Git. Features could be broken without ever changing the feature file, for example if a common step definition is broken. Next steps are to identify all the step definitions used by a feature and examine how often the step definitions have changed.</p>

<p>First find the change count for all the step definitions.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">step_files</span> <span class="o">=</span> <span class="no">Dir</span><span class="o">[</span><span class="s2">&quot;features/**/*_steps.rb&quot;</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'><span class="n">step_files</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">step_file</span><span class="o">|</span>
</span><span class='line'>  <span class="n">change_logs</span> <span class="o">=</span> <span class="sb">`git log --oneline </span><span class="si">#{</span><span class="n">step_file</span><span class="si">}</span><span class="sb"> 2&gt;/dev/null`</span>
</span><span class='line'>  <span class="n">change_count</span> <span class="o">=</span> <span class="n">change_logs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">step_file</span><span class="si">}</span><span class="s2">,</span><span class="si">#{</span><span class="n">change_count</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then working out what step definitions a feature uses.  We can do this by running cucumber with the json formatter and match up step definitions (and hence step definition files) to feature files:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;json&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="sb">`cucumber features --dry-run --format json --out .json.out`</span>
</span><span class='line'><span class="n">features_json</span> <span class="o">=</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;.json.out&#39;</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="n">stats</span> <span class="o">=</span> <span class="no">Hash</span><span class="o">.</span><span class="n">new</span><span class="p">{</span><span class="o">|</span><span class="n">h</span><span class="p">,</span><span class="n">k</span><span class="o">|</span> <span class="n">h</span><span class="o">[</span><span class="n">k</span><span class="o">]</span> <span class="o">=</span> <span class="o">[]</span><span class="p">}</span>
</span><span class='line'><span class="n">features_json</span><span class="o">[</span><span class="s1">&#39;features&#39;</span><span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">feature</span><span class="o">|</span>
</span><span class='line'>  <span class="n">feature_name</span> <span class="o">=</span> <span class="n">feature</span><span class="o">[</span><span class="s1">&#39;name&#39;</span><span class="o">]</span>
</span><span class='line'>  <span class="c1">#The JSON does not have the feature file. Find the file via the feature name. Messy</span>
</span><span class='line'>  <span class="n">feature_file</span> <span class="o">=</span> <span class="sb">`egrep -riE &quot;feature:? *</span><span class="si">#{</span><span class="n">feature_name</span><span class="si">}</span><span class="sb">&quot; features/`</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
</span><span class='line'>  <span class="n">feature</span><span class="o">[</span><span class="s2">&quot;elements&quot;</span><span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">element</span><span class="o">|</span>
</span><span class='line'>    <span class="n">element</span><span class="o">[</span><span class="s2">&quot;steps&quot;</span><span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">step</span><span class="o">|</span>
</span><span class='line'>      <span class="n">file_location</span> <span class="o">=</span> <span class="n">step</span><span class="o">[</span><span class="s1">&#39;match&#39;</span><span class="o">][</span><span class="s1">&#39;location&#39;</span><span class="o">]</span>
</span><span class='line'>      <span class="n">file</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">file_location</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">file</span> <span class="o">=~</span> <span class="sr">/_steps\.rb$/</span>
</span><span class='line'>        <span class="n">stats</span><span class="o">[</span><span class="n">feature_file</span><span class="o">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">stats</span><span class="o">[</span><span class="n">feature_file</span><span class="o">]</span> <span class="o">+</span> <span class="o">[</span><span class="n">file</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">uniq</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="n">pp</span> <span class="n">stats</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Change rate vs Failure rate with step definition changes</h2>

<p>Combining those two bits of data we can now add to our original graph the step definition change rates for a feature.
<img src="/images/blog/2011/07/with_steps.png" alt="" /></p>

<p>We also can examine an individual break down of the step definition change rates for a feature:</p>

<p><img src="/images/blog/2011/07/step_def.png" alt="" /></p>

<h2>Holes in using the step definition change rate</h2>

<p>The step definition changes from git are at the file level (the *_step.rb file) so a change in git may not touch a step definition used by a feature. Hence we may be counting changes which are not relevant for a feature. Further work would be to examine the git diffs and check if a change touched a step definition used by a feature.</p>

<h2>Conclusions</h2>

<p>Our tests hide lots of interesting information that can provide evidence of areas we can make improvements. It&rsquo;s important to realise that like anything in statistics our data mining does not yield facts, just suggestions. At Songkick we are already mining this information with Cucumber and using it to help improve and learn about our tests.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/personal/conferences-and-accessibility-please-try-harder.html">Conferences and Accessibility: Please Try Harder</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-06-27T13:25:23+01:00" pubdate data-updated="true">Jun 27<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I speak at a lot of conferences around the world and I&rsquo;ve been happy to hear a lot of healthy debate around the diversity of the programming community. I really enjoyed and felt inspired by the talk from <a href="http://blogs.thewehners.net/josh">Joshua Wehner</a> on &ldquo;Must It Always Be About Sex&rdquo; at <a href="http://nordicruby.org/">Nordic Ruby</a> and <a href="http://rulu.eu/">Ruby Lugdunum.</a></p>

<p>It got me thinking about the issue of accessibility at conferences. I use a wheelchair and happily throw myself at any conference irrelevant of the obstacles. But not everyone is as crazy or as flexible as I am. Once at the conference the organisers are always willing to help but I wonder if we are not excluding disabled people who may dimiss the chance to talk or attend as unfeasible due to lack of information about access. Even if thats only a few people, those people are valuable members of our communities and deserve the chance to participate if they want to.</p>

<p>How would we ever know if we were discriminating, if no-one turns up in a wheelchair we are none the wiser.</p>

<p>I understand conferences are expensive and complicated events to organise. I would ask two small things of every conference organiser:</p>

<p><strong>1. Try and select an accessible venue if possible. For both speakers and attendees.</strong></p>

<p><strong>2. Make it clear on the conference website if the venue, party, hack sessions are accessible or not.</strong></p>

<p>My life was profoundly changed through speaking and attending conferences, in many ways beyond programming. I hope we can make sure anyone who wants that opportunity won&rsquo;t be put off.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/3/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/clojure/overtone-driving-minecraft.html">Clojure and Overtone driving Minecraft</a>
      </li>
    
      <li class="post">
        <a href="/art/live-coding-repl-electric.html">Live Coding - Repl Electric</a>
      </li>
    
      <li class="post">
        <a href="/clojure/creative_machines.html">Creative Machines</a>
      </li>
    
      <li class="post">
        <a href="/clojure/sounds-of-the-human-brain.html">Sounds of the human brain</a>
      </li>
    
      <li class="post">
        <a href="/clojure/building-clojure-services-at-scale.html">Building Clojure services at scale</a>
      </li>
    
      <li class="post">
        <a href="/clojure/creating-instruments-with-overtone.html">Creating sampled instruments with Overtone</a>
      </li>
    
      <li class="post">
        <a href="/elixir/sets-in-elixir.html">Sets in Elixir</a>
      </li>
    
      <li class="post">
        <a href="/clojure/isolating-external-dependencies-in-clojure.html">Isolating external dependencies in Clojure</a>
      </li>
    
      <li class="post">
        <a href="/presentations/a-developers-guide-to-creating-presentations.html">A developers guide to creating presentations</a>
      </li>
    
      <li class="post">
        <a href="/software-craftmanship/the-aesthetics-of-density.html">The Aesthetics of Density</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/josephwilk">@josephwilk</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'josephwilk',
            count: 10,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Joseph Wilk -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'josephwilk';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
